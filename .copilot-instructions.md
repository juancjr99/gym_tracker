# Gym App - Instrucciones para Copilot

## Descripción del Proyecto
Esta es una aplicación Flutter para llevar el registro de entrenamientos en el gimnasio. La app permite crear rutinas tradicionales y de circuito, registrar series, repeticiones, peso y tiempo, y comparar entrenamientos anteriores.

## Buenas Prácticas Obligatorias

### 1. Arquitectura y Gestión de Estado
- **OBLIGATORIO**: Utilizar **BLoC (Business Logic Component)** como gestor de estado principal
- **PROHIBIDO**: Usar StatefulWidgets - reemplazar con StatelessWidget + BLoC
- Separar la lógica de negocio de la UI usando el patrón BLoC
- Implementar eventos y estados claros para cada funcionalidad
- Usar `flutter_bloc` para la implementación del patrón

### 2. Material Design 3
- **OBLIGATORIO**: Implementar Material Design 3 (Material You)
- Usar `useMaterial3: true` en el ThemeData
- Implementar esquemas de color dinámicos con `ColorScheme.fromSeed()`
- Utilizar componentes M3: NavigationBar, NavigationRail, etc.
- Seguir las guías de espaciado y tipografía de M3

### 3. Estructura de Archivos
```
lib/
├── main.dart
├── app/
│   ├── app.dart
│   └── routes/
├── core/
│   ├── constants/
│   ├── theme/
│   ├── utils/
│   └── extensions/
├── data/
│   ├── models/
│   ├── repositories/
│   └── datasources/
├── domain/
│   ├── entities/
│   ├── repositories/
│   └── usecases/
├── presentation/
│   ├── bloc/
│   ├── pages/
│   ├── widgets/
│   └── common/
└── injection/
    └── dependency_injection.dart
```

### 4. Modelos de Datos Principales

#### Ejercicio
```dart
class Exercise {
  final String id;
  final String name;
  final String category;
  final ExerciseType type; // weight, time, bodyweight
  final String? description;
  final String? imageUrl;
  final List<String> muscleGroups;
}
```

#### Rutina
```dart
class Routine {
  final String id;
  final String name;
  final String? description;
  final List<RoutineExercise> exercises;
  final RoutineType type; // traditional, circuit
  final DateTime createdAt;
  final DateTime updatedAt;
}
```

#### Registro de Entrenamiento
```dart
class WorkoutRecord {
  final String id;
  final String routineId;
  final DateTime date;
  final Duration totalDuration;
  final List<ExerciseRecord> exerciseRecords;
  final String? notes;
}
```

#### Registro de Ejercicio
```dart
class ExerciseRecord {
  final String exerciseId;
  final List<SetRecord> sets;
  final Duration? totalTime; // para ejercicios por tiempo
}
```

### 5. Funcionalidades Requeridas

#### Gestión de Rutinas
- Crear rutinas tradicionales (series x repeticiones)
- Crear rutinas de circuito
- Editar y eliminar rutinas
- Duplicar rutinas
- Organizar ejercicios por orden

#### Registro de Entrenamientos
- Seleccionar rutina del día
- Registrar peso, repeticiones, tiempo
- Cronómetro para descansos
- Notas por ejercicio
- Guardar progreso automáticamente

#### Análisis y Comparación
- Historial de entrenamientos
- Gráficos de progreso por ejercicio
- Comparación con entrenamientos anteriores
- Estadísticas de rendimiento
- Máximos personales (PR)

### 6. Reglas de Código

#### Widgets
- **NUNCA** usar StatefulWidget, siempre StatelessWidget + BLoC
- Crear widgets reutilizables para componentes comunes
- Usar const constructors cuando sea posible
- Implementar keys apropiadas para widgets de lista

#### Gestión de Estado
```dart
// ✅ CORRECTO
class WorkoutPage extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return BlocProvider(
      create: (context) => WorkoutBloc(),
      child: BlocBuilder<WorkoutBloc, WorkoutState>(
        builder: (context, state) {
          // UI basada en estado
        },
      ),
    );
  }
}

// ❌ INCORRECTO
class WorkoutPage extends StatefulWidget {
  // No usar StatefulWidget
}
```

#### Navegación
- Usar named routes con GoRouter
- Implementar navegación tipo-segura
- Manejar deep links apropiadamente

#### Persistencia de Datos
- Usar SQLite con Floor para datos locales
- Implementar patrón Repository
- Crear abstracciones para fuentes de datos

### 7. Dependencias Actualizadas (2025)
```yaml
dependencies:
  # Estado
  bloc: ^9.1.0
  flutter_bloc: ^9.1.1
  equatable: ^2.0.5
  
  # Navegación
  go_router: ^17.0.0
  
  # Persistencia
  floor: ^1.5.0
  shared_preferences: ^2.3.2
  
  # UI/UX
  phosphor_flutter: ^2.1.0
  table_calendar: ^3.1.2
  fl_chart: ^1.1.1
  
  # Utilidades
  uuid: ^4.5.1
  intl: ^0.20.2
  formz: ^0.8.0
  
  # Inyección de dependencias
  get_it: ^9.0.5
  injectable: ^2.5.0

dev_dependencies:
  # Generación de código
  build_runner: ^2.4.13
  floor_generator: ^1.5.0
  injectable_generator: ^2.6.2
  
  # Testing
  bloc_test: ^10.0.0
  mocktail: ^1.0.4
  patrol: ^3.12.0
  very_good_analysis: ^10.0.0
```

### 8. Tema y UI
- Usar sistema de colores semánticos
- Implementar modo claro y oscuro
- Responsive design para tablets
- Animaciones fluidas con Material motion
- Accesibilidad completa (semantics, contrast, etc.)

### 9. Testing
- Unit tests para BLoCs y repositories
- Widget tests para componentes UI
- Integration tests para flujos principales
- Mocking apropiado para dependencias

### 10. Reglas Específicas para Entrenamientos

#### Tipos de Ejercicios
1. **Por Peso**: series x repeticiones + peso
2. **Por Tiempo**: tiempo total (ej: plank, cardio)
3. **Peso Corporal**: series x repeticiones sin peso

#### Flujo de Entrenamiento
1. Seleccionar rutina
2. Iniciar entrenamiento
3. Completar ejercicios uno por uno
4. Registrar datos (peso/reps/tiempo)
5. Guardar automáticamente
6. Mostrar resumen final

#### Comparación de Progreso
- Mostrar último entrenamiento de mismo ejercicio
- Indicadores visuales de mejora/retroceso
- Gráficos de tendencia temporal
- Notificaciones de nuevos récords

## Comandos Útiles
```bash
# Instalar dependencias
flutter pub get

# Generar modelos Floor e Inyección de dependencias
flutter packages pub run build_runner build --delete-conflicting-outputs

# Correr tests
flutter test

# Tests de integración
flutter test integration_test/

# Análisis de código
flutter analyze

# Formatear código
dart format lib/

# Verificar dependencias obsoletas
flutter pub outdated

# Limpiar proyecto
flutter clean
```

## Estructura de Features Recomendada
```
lib/features/
├── authentication/
│   ├── data/
│   ├── domain/
│   └── presentation/
├── routines/
│   ├── data/
│   ├── domain/
│   └── presentation/
├── workouts/
│   ├── data/
│   ├── domain/
│   └── presentation/
├── exercises/
│   ├── data/
│   ├── domain/
│   └── presentation/
├── progress/
│   ├── data/
│   ├── domain/
│   └── presentation/
└── settings/
    ├── data/
    ├── domain/
    └── presentation/
```

## Notas Importantes
- Siempre validar entrada de datos
- Manejar errores graciosamente
- Mantener UX fluida durante registros
- Backup automático de datos
- Permitir exportación de datos
- Usar nomenclatura en español para UI pero en inglés para código
- Implementar logging apropiado para debugging
- Optimizar rendimiento con const constructors y keys
- Seguir principios SOLID en toda la arquitectura

## Ejemplos de Implementación

### BLoC para Rutinas
```dart
// eventos
abstract class RoutineEvent extends Equatable {
  const RoutineEvent();
}

class LoadRoutines extends RoutineEvent {
  @override
  List<Object> get props => [];
}

class CreateRoutine extends RoutineEvent {
  const CreateRoutine(this.routine);
  final Routine routine;
  
  @override
  List<Object> get props => [routine];
}

// estados
abstract class RoutineState extends Equatable {
  const RoutineState();
}

class RoutineInitial extends RoutineState {
  @override
  List<Object> get props => [];
}

class RoutineLoading extends RoutineState {
  @override
  List<Object> get props => [];
}

class RoutineLoaded extends RoutineState {
  const RoutineLoaded(this.routines);
  final List<Routine> routines;
  
  @override
  List<Object> get props => [routines];
}
```

### Widget con BLoC
```dart
class RoutineListPage extends StatelessWidget {
  const RoutineListPage({super.key});

  @override
  Widget build(BuildContext context) {
    return BlocProvider(
      create: (context) => getIt<RoutineBloc>()..add(const LoadRoutines()),
      child: Scaffold(
        appBar: AppBar(
          title: const Text('Mis Rutinas'),
        ),
        body: BlocBuilder<RoutineBloc, RoutineState>(
          builder: (context, state) {
            if (state is RoutineLoading) {
              return const Center(
                child: CircularProgressIndicator(),
              );
            }
            
            if (state is RoutineLoaded) {
              return ListView.builder(
                itemCount: state.routines.length,
                itemBuilder: (context, index) {
                  final routine = state.routines[index];
                  return RoutineCard(routine: routine);
                },
              );
            }
            
            return const Center(
              child: Text('No hay rutinas disponibles'),
            );
          },
        ),
        floatingActionButton: FloatingActionButton(
          onPressed: () => Navigator.pushNamed(context, '/create-routine'),
          child: const Icon(Icons.add),
        ),
      ),
    );
  }
}
```